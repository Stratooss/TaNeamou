<!doctype html>
<html lang="el">
  <head>
    <meta charset="utf-8" />
    <title>Î•ÏÎºÎ¿Î»Î± ÎÎ­Î± â€“ ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background-color: #ffffff;
        font-size: 18px;
        line-height: 1.6;
      }

      .site-header {
        background: #1d4ed8;
        color: white;
        padding: 1.2rem 0;
        margin-bottom: 1.2rem;
      }

      .site-title {
        font-size: 1.6rem;
        font-weight: 700;
      }

      .site-subtitle {
        font-size: 0.95rem;
        opacity: 0.98;
      }

      .article-card {
        border-radius: 16px;
        border: 1px solid #e5e7eb;
        padding: 1rem 1.2rem;
        margin-bottom: 1rem;
        box-shadow: 0 2px 6px rgba(15, 23, 42, 0.1);
        background: #ffffff;
      }

      .article-card h2 {
        margin-top: 0;
        font-size: 1.2rem;
      }

      .meta {
        font-size: 0.85rem;
        color: #4b5563;
        margin-bottom: 0.4rem;
      }

      .content {
        white-space: pre-wrap;
        font-size: 1rem;
      }

      .back-link {
        font-size: 0.95rem;
        margin-bottom: 1rem;
        display: inline-block;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="site-header">
      <div class="container">
        <div class="d-flex flex-column align-items-start gap-1">
          <div class="site-title">ğŸ“° Î•ÏÎºÎ¿Î»Î± ÎÎ­Î±</div>
          <div class="site-subtitle">Î¤Î± Î½Î­Î± ÏƒÎµ Î±Ï€Î»Î¬ ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬</div>
        </div>
      </div>
    </header>

    <main class="container mb-5">
      <a href="index.html" class="back-link">â† Î Î¯ÏƒÏ‰ ÏƒÏ„Î¿ Î¼ÎµÎ½Î¿Ï ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½</a>
      <h1 id="page-title" class="h4 mb-3">Î•Î¹Î´Î®ÏƒÎµÎ¹Ï‚</h1>

      <div id="content"></div>
    </main>

    <script>
      const params = new URLSearchParams(window.location.search);
      const category = params.get("category") || "serious";

      const LIFESTYLE_CATEGORIES = ["sports", "movies", "music", "theatre", "series", "fun"];

      // metadata Î³Î¹Î± Ï„Î¹Ï‚ 3 ÏƒÎ¿Î²Î±ÏÎ­Ï‚ Î¸ÎµÎ¼Î±Ï„Î¹ÎºÎ­Ï‚
      const SERIOUS_TOPIC_META = {
        politics_economy: {
          label: "Î Î¿Î»Î¹Ï„Î¹ÎºÎ® & ÎŸÎ¹ÎºÎ¿Î½Î¿Î¼Î¯Î±",
          description: "Î¤Î¹ Î³Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ ÎºÏ…Î²Î­ÏÎ½Î·ÏƒÎ·, ÏƒÏ„Î· Î²Î¿Ï…Î»Î® ÎºÎ±Î¹ ÏƒÏ„Î·Î½ Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î¯Î±.",
          image: "images/serious/politics.jpg", // ÎµÎ´Ï Î¸Î± Î²Î¬Î»ÎµÎ¹Ï‚ Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ¿Ï… thumbnail
        },
        social: {
          label: "ÎšÎ¿Î¹Î½Ï‰Î½Î¯Î±",
          description: "Î˜Î­Î¼Î±Ï„Î± Ï€Î¿Ï… Î±Ï†Î¿ÏÎ¿ÏÎ½ Ï„Î·Î½ ÎºÎ±Î¸Î·Î¼ÎµÏÎ¹Î½Î® Î¶Ï‰Î® ÎºÎ±Î¹ Ï„Î¿Ï…Ï‚ Î±Î½Î¸ÏÏÏ€Î¿Ï…Ï‚.",
          image: "images/serious/social.jpg",
        },
        world: {
          label: "ÎšÏŒÏƒÎ¼Î¿Ï‚",
          description: "Î£Î·Î¼Î±Î½Ï„Î¹ÎºÎ¬ Î³ÎµÎ³Î¿Î½ÏŒÏ„Î± Î±Ï€ÏŒ Î¬Î»Î»ÎµÏ‚ Ï‡ÏÏÎµÏ‚.",
          image: "images/serious/world.jpg",
        },
      };

      const pageTitleMap = {
        serious: "Î£Î¿Î²Î±ÏÎ­Ï‚ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚",
        sports: "Î‘Î¸Î»Î·Ï„Î¹ÎºÎ¬",
        movies: "Î¤Î±Î¹Î½Î¯ÎµÏ‚",
        music: "ÎœÎ¿Ï…ÏƒÎ¹ÎºÎ®",
        theatre: "Î˜Î­Î±Ï„ÏÎ¿",
        series: "Î£ÎµÎ¹ÏÎ­Ï‚",
        fun: "Î”Î¹Î±ÏƒÎºÎ­Î´Î±ÏƒÎ· / Î’ÏŒÎ»Ï„ÎµÏ‚",
        other: "Î†Î»Î»ÎµÏ‚ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚",
        all: "ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚",
      };

      document.getElementById("page-title").textContent =
        pageTitleMap[category] || "Î•Î¹Î´Î®ÏƒÎµÎ¹Ï‚";

      async function loadJson(path) {
        const res = await fetch(path);
        if (!res.ok) {
          throw new Error("Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î± Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ " + path);
        }
        return res.json();
      }

      function renderNewsArticles(articles) {
        const container = document.getElementById("content");
        container.innerHTML = "";

        if (!articles || !articles.length) {
          container.innerHTML = "<p>Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Î±Ï…Ï„Î® Ï„Î·Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±.</p>";
          return;
        }

        for (const article of articles) {
          const card = document.createElement("article");
          card.className = "article-card";

          const titleEl = document.createElement("h2");
          titleEl.textContent = article.simpleTitle || article.title || "Î§Ï‰ÏÎ¯Ï‚ Ï„Î¯Ï„Î»Î¿";

          const metaEl = document.createElement("div");
          metaEl.className = "meta";
          const metaParts = [];
          if (article.sourceName) metaParts.push(article.sourceName);
          if (article.publishedAt) {
            const d = new Date(article.publishedAt);
            metaParts.push(d.toLocaleString("el-GR"));
          }
          metaEl.textContent = metaParts.join(" â€¢ ");

          const contentEl = document.createElement("div");
          contentEl.className = "content";
          contentEl.textContent = article.simpleText || "";

          if (article.sourceUrl) {
            const linkEl = document.createElement("a");
            linkEl.href = article.sourceUrl;
            linkEl.target = "_blank";
            linkEl.rel = "noopener noreferrer";
            linkEl.textContent = "Î”ÎµÏ‚ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® Ï€Î·Î³Î®";
            linkEl.style.display = "block";
            linkEl.style.marginTop = "0.5rem";
            contentEl.appendChild(document.createElement("br"));
            contentEl.appendChild(linkEl);
          }

          card.appendChild(titleEl);
          card.appendChild(metaEl);
          card.appendChild(contentEl);

          container.appendChild(card);
        }
      }

      function renderLifestyleArticle(article) {
        const container = document.getElementById("content");
        container.innerHTML = "";

        if (!article) {
          container.innerHTML =
            "<p>Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Î³Î¹Î± Î±Ï…Ï„Î® Ï„Î·Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±. ÎŠÏƒÏ‰Ï‚ Î½Î± Î¼Î·Î½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î½Î­Î± ÏƒÎ®Î¼ÎµÏÎ±.</p>";
          return;
        }

        const card = document.createElement("article");
        card.className = "article-card";

        const titleEl = document.createElement("h2");
        titleEl.textContent = article.title || "Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿";

        const metaEl = document.createElement("div");
        metaEl.className = "meta";
        const metaParts = [];
        if (article.date) metaParts.push("Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±: " + article.date);
        if (article.sources && article.sources.length) {
          metaParts.push("Î’Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î¿ ÏƒÎµ " + article.sources.length + " Ï€Î·Î³Î­Ï‚");
        }
        metaEl.textContent = metaParts.join(" â€¢ ");

        const contentEl = document.createElement("div");
        contentEl.className = "content";
        contentEl.textContent = article.simpleText || "";

        // Î›Î¯ÏƒÏ„Î± Ï€Î·Î³ÏÎ½
        if (article.sources && article.sources.length) {
          const sourcesTitle = document.createElement("div");
          sourcesTitle.style.marginTop = "0.8rem";
          sourcesTitle.textContent = "Î Î·Î³Î­Ï‚:";

          const ul = document.createElement("ul");
          for (const s of article.sources) {
            const li = document.createElement("li");
            if (s.url) {
              const a = document.createElement("a");
              a.href = s.url;
              a.target = "_blank";
              a.rel = "noopener noreferrer";
              a.textContent = s.source || s.sourceName || s.url;
              li.appendChild(a);
            } else {
              li.textContent = s.source || s.sourceName || "Î Î·Î³Î®";
            }
            ul.appendChild(li);
          }

          contentEl.appendChild(sourcesTitle);
          contentEl.appendChild(ul);
        }

        card.appendChild(titleEl);
        card.appendChild(metaEl);
        card.appendChild(contentEl);

        container.appendChild(card);
      }

      // ğŸ”¹ Î£ÎµÎ»Î¯Î´Î± "Ï…Ï€Î¿-ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½" Î³Î¹Î± Î£Î¿Î²Î±ÏÎ­Ï‚ Î•Î¹Î´Î®ÏƒÎµÎ¹Ï‚
      async function renderSeriousCategories() {
        const container = document.getElementById("content");
        container.innerHTML = "";

        try {
          const data = await loadJson("./serious-digest.json");
          const digestArticles = Array.isArray(data.articles) ? data.articles : [];

          if (!digestArticles.length) {
            container.innerHTML =
              "<p>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± Î¬ÏÎ¸ÏÎ± ÏƒÎ¿Î²Î±ÏÎ®Ï‚ ÎµÏ€Î¹ÎºÎ±Î¹ÏÏŒÏ„Î·Ï„Î±Ï‚ Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î®.</p>";
            return;
          }

          // map topic -> Î¬ÏÎ¸ÏÎ¿
          const byTopic = {};
          for (const a of digestArticles) {
            if (a.topic) {
              byTopic[a.topic] = a;
            }
          }

          const topicsInOrder = ["politics_economy", "social", "world"];

          for (const topic of topicsInOrder) {
            const digest = byTopic[topic];
            if (!digest) continue;

            const meta = SERIOUS_TOPIC_META[topic] || {
              label: digest.topicLabel || "Î£Î¿Î²Î±ÏÎ® ÎµÎ¯Î´Î·ÏƒÎ·",
              description: "",
              image: "",
            };

            const card = document.createElement("article");
            card.className =
              "article-card d-flex flex-column flex-md-row align-items-md-center";

            if (meta.image) {
              const imgWrapper = document.createElement("div");
              imgWrapper.style.flex = "0 0 140px";
              imgWrapper.style.marginRight = "1rem";
              imgWrapper.style.marginBottom = "0.75rem";

              const img = document.createElement("img");
              img.src = meta.image;
              img.alt = meta.label;
              img.style.width = "100%";
              img.style.borderRadius = "12px";
              img.style.objectFit = "cover";

              imgWrapper.appendChild(img);
              card.appendChild(imgWrapper);
            }

            const bodyDiv = document.createElement("div");
            bodyDiv.style.flex = "1 1 auto";

            const titleEl = document.createElement("h2");
            titleEl.textContent = meta.label;
            bodyDiv.appendChild(titleEl);

            if (meta.description) {
              const descEl = document.createElement("p");
              descEl.className = "mb-1";
              descEl.textContent = meta.description;
              bodyDiv.appendChild(descEl);
            }

            if (digest.simpleText) {
              const snippetEl = document.createElement("p");
              snippetEl.className = "text-muted mb-2";
              const firstLine = digest.simpleText.split("\n")[0] || "";
              const snippet =
                firstLine.length > 160
                  ? firstLine.slice(0, 157) + "..."
                  : firstLine;
              snippetEl.textContent = snippet;
              bodyDiv.appendChild(snippetEl);
            }

            const buttonEl = document.createElement("a");
            buttonEl.href =
              "article.html?source=serious&topic=" + encodeURIComponent(topic);
            buttonEl.className = "btn btn-primary btn-sm";
            buttonEl.textContent = "Î”ÎµÏ‚ Ï„Î·Î½ ÎµÎ¯Î´Î·ÏƒÎ·";
            bodyDiv.appendChild(buttonEl);

            card.appendChild(bodyDiv);
            container.appendChild(card);
          }

          if (!container.hasChildNodes()) {
            container.innerHTML =
              "<p>Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ Î¬ÏÎ¸ÏÎ± ÏƒÎ¿Î²Î±ÏÎ®Ï‚ ÎµÏ€Î¹ÎºÎ±Î¹ÏÏŒÏ„Î·Ï„Î±Ï‚ Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î®.</p>";
          }
        } catch (err) {
          console.error("Î£Ï†Î¬Î»Î¼Î± Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ serious-digest.json:", err);
          container.innerHTML =
            "<p>Î ÏÎ¿Î­ÎºÏ…ÏˆÎµ Ï€ÏÏŒÎ²Î»Î·Î¼Î± ÏƒÏ„Î·Î½ Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Ï„Ï‰Î½ ÏƒÎ¿Î²Î±ÏÏÎ½ ÎµÎ¹Î´Î®ÏƒÎµÏ‰Î½.</p>";
        }
      }

      async function init() {
        try {
          if (category === "all") {
            // ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ news.json
            const newsData = await loadJson("./news.json");
            const all = Array.isArray(newsData.articles) ? newsData.articles : [];
            renderNewsArticles(all);
          } else if (category === "serious") {
            // ğŸ”¹ Î£Î¿Î²Î±ÏÎ­Ï‚ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚: Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î¼Îµ 3 ÎºÎ¬ÏÏ„ÎµÏ‚ Î¸ÎµÎ¼Î±Ï„Î¹ÎºÏÎ½
            await renderSeriousCategories();
          } else if (!LIFESTYLE_CATEGORIES.includes(category)) {
            // ÎœÎ·-lifestyle ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚ Î±Ï€ÏŒ news.json
            const newsData = await loadJson("./news.json");
            const byCategory = newsData.articlesByCategory || {};
            const articles = byCategory[category] || [];
            renderNewsArticles(articles);
          } else {
            // Lifestyle ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚ Î±Ï€ÏŒ lifestyle.json
            const lifestyleData = await loadJson("./lifestyle.json");
            const list = lifestyleData.articles || [];
            const article = list.find((a) => a.category === category);
            renderLifestyleArticle(article);
          }
        } catch (err) {
          console.error(err);
          document.getElementById("content").innerHTML =
            "<p>Î¥Ï€Î®ÏÎ¾Îµ ÏƒÏ†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î· Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.</p>";
        }
      }

      init();
    </script>
  </body>
</html>

